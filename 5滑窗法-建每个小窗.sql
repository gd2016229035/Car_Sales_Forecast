-- 滑窗法
-- 滑窗法，建每个小窗，每个小窗12个月，相隔一年 label是最后一个feature后的第二个月 lable范围201708-201712 共16个
drop table if exists final_slide_12month_inter2_all0;
CREATE TABLE if not exists final_slide_12month_inter2_all0(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
INSERT INTO final_slide_12month_inter2_all0(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12,lable)
select traindata_201712_all.*,all_num_feature201608.avgyear,all_num_feature201608.medianyear,all_num_feature201608.maxyear,all_num_feature201608.minyear,all_num_feature201608.stdyear,all_num_feature201608.sumyear,all_num_feature201608.monthyear, 9,sales_and_yield2.yield_201602,sales_and_yield2.yield_201603,sales_and_yield2.yield_201604,sales_and_yield2.yield_201605,sales_and_yield2.yield_201606,sales_and_yield2.yield_201607,sales_and_yield2.sale_201508,sales_and_yield2.sale_201509,sales_and_yield2.sale_201510,sales_and_yield2.sale_201511,sales_and_yield2.sale_201512,sales_and_yield2.sale_201601,sales_and_yield2.sale_201602,sales_and_yield2.sale_201603,sales_and_yield2.sale_201604,sales_and_yield2.sale_201605,sales_and_yield2.sale_201606,sales_and_yield2.sale_201607,sales_and_yield2.sale_201609
from traindata_201712_all left join sales_and_yield2 on traindata_201712_all.class_id=sales_and_yield2.class_id and traindata_201712_all.city_id=sales_and_yield2.city_id and traindata_201712_all.province_id=sales_and_yield2.province_id
left join all_num_feature201608
on traindata_201712_all.class_id=all_num_feature201608.class_id and traindata_201712_all.city_id=all_num_feature201608.city_id and traindata_201712_all.province_id=all_num_feature201608.province_id;

drop table if exists final_slide_12month_inter2_all1;
CREATE TABLE if not exists final_slide_12month_inter2_all1(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
INSERT INTO final_slide_12month_inter2_all1(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12,lable)
select traindata_201712_all.*,all_num_feature201609.avgyear,all_num_feature201609.medianyear,all_num_feature201609.maxyear,all_num_feature201609.minyear,all_num_feature201609.stdyear,all_num_feature201609.sumyear,all_num_feature201609.monthyear, 10,sales_and_yield2.yield_201603,sales_and_yield2.yield_201604,sales_and_yield2.yield_201605,sales_and_yield2.yield_201606,sales_and_yield2.yield_201607,sales_and_yield2.yield_201608,sales_and_yield2.sale_201509,sales_and_yield2.sale_201510,sales_and_yield2.sale_201511,sales_and_yield2.sale_201512,sales_and_yield2.sale_201601,sales_and_yield2.sale_201602,sales_and_yield2.sale_201603,sales_and_yield2.sale_201604,sales_and_yield2.sale_201605,sales_and_yield2.sale_201606,sales_and_yield2.sale_201607,sales_and_yield2.sale_201608,sales_and_yield2.sale_201610
from traindata_201712_all left join sales_and_yield2 on traindata_201712_all.class_id=sales_and_yield2.class_id and traindata_201712_all.city_id=sales_and_yield2.city_id and traindata_201712_all.province_id=sales_and_yield2.province_id
left join all_num_feature201609
on traindata_201712_all.class_id=all_num_feature201609.class_id and traindata_201712_all.city_id=all_num_feature201609.city_id and traindata_201712_all.province_id=all_num_feature201609.province_id;

drop table if exists final_slide_12month_inter2_all2;
CREATE TABLE if not exists final_slide_12month_inter2_all2(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
INSERT INTO final_slide_12month_inter2_all2(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12,lable)
select traindata_201712_all.*,all_num_feature201610.avgyear,all_num_feature201610.medianyear,all_num_feature201610.maxyear,all_num_feature201610.minyear,all_num_feature201610.stdyear,all_num_feature201610.sumyear,all_num_feature201610.monthyear, 11,sales_and_yield2.yield_201604,sales_and_yield2.yield_201605,sales_and_yield2.yield_201606,sales_and_yield2.yield_201607,sales_and_yield2.yield_201608,sales_and_yield2.yield_201609,sales_and_yield2.sale_201510,sales_and_yield2.sale_201511,sales_and_yield2.sale_201512,sales_and_yield2.sale_201601,sales_and_yield2.sale_201602,sales_and_yield2.sale_201603,sales_and_yield2.sale_201604,sales_and_yield2.sale_201605,sales_and_yield2.sale_201606,sales_and_yield2.sale_201607,sales_and_yield2.sale_201608,sales_and_yield2.sale_201609,sales_and_yield2.sale_201611
from traindata_201712_all left join sales_and_yield2 on traindata_201712_all.class_id=sales_and_yield2.class_id and traindata_201712_all.city_id=sales_and_yield2.city_id and traindata_201712_all.province_id=sales_and_yield2.province_id
left join all_num_feature201610
on traindata_201712_all.class_id=all_num_feature201610.class_id and traindata_201712_all.city_id=all_num_feature201610.city_id and traindata_201712_all.province_id=all_num_feature201610.province_id;

drop table if exists final_slide_12month_inter2_all3;
CREATE TABLE if not exists final_slide_12month_inter2_all3(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
INSERT INTO final_slide_12month_inter2_all3(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12,lable)
select traindata_201712_all.*,all_num_feature201611.avgyear,all_num_feature201611.medianyear,all_num_feature201611.maxyear,all_num_feature201611.minyear,all_num_feature201611.stdyear,all_num_feature201611.sumyear,all_num_feature201611.monthyear, 12,sales_and_yield2.yield_201605,sales_and_yield2.yield_201606,sales_and_yield2.yield_201607,sales_and_yield2.yield_201608,sales_and_yield2.yield_201609,sales_and_yield2.yield_201610,sales_and_yield2.sale_201511,sales_and_yield2.sale_201512,sales_and_yield2.sale_201601,sales_and_yield2.sale_201602,sales_and_yield2.sale_201603,sales_and_yield2.sale_201604,sales_and_yield2.sale_201605,sales_and_yield2.sale_201606,sales_and_yield2.sale_201607,sales_and_yield2.sale_201608,sales_and_yield2.sale_201609,sales_and_yield2.sale_201610,sales_and_yield2.sale_201612
from traindata_201712_all left join sales_and_yield2 on traindata_201712_all.class_id=sales_and_yield2.class_id and traindata_201712_all.city_id=sales_and_yield2.city_id and traindata_201712_all.province_id=sales_and_yield2.province_id
left join all_num_feature201611
on traindata_201712_all.class_id=all_num_feature201611.class_id and traindata_201712_all.city_id=all_num_feature201611.city_id and traindata_201712_all.province_id=all_num_feature201611.province_id;

drop table if exists final_slide_12month_inter2_all4;
CREATE TABLE if not exists final_slide_12month_inter2_all4(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
INSERT INTO final_slide_12month_inter2_all4(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12,lable)
select traindata_201712_all.*,all_num_feature201612.avgyear,all_num_feature201612.medianyear,all_num_feature201612.maxyear,all_num_feature201612.minyear,all_num_feature201612.stdyear,all_num_feature201612.sumyear,all_num_feature201612.monthyear, 1,sales_and_yield2.yield_201606,sales_and_yield2.yield_201607,sales_and_yield2.yield_201608,sales_and_yield2.yield_201609,sales_and_yield2.yield_201610,sales_and_yield2.yield_201611,sales_and_yield2.sale_201512,sales_and_yield2.sale_201601,sales_and_yield2.sale_201602,sales_and_yield2.sale_201603,sales_and_yield2.sale_201604,sales_and_yield2.sale_201605,sales_and_yield2.sale_201606,sales_and_yield2.sale_201607,sales_and_yield2.sale_201608,sales_and_yield2.sale_201609,sales_and_yield2.sale_201610,sales_and_yield2.sale_201611,sales_and_yield2.sale_201701
from traindata_201712_all left join sales_and_yield2 on traindata_201712_all.class_id=sales_and_yield2.class_id and traindata_201712_all.city_id=sales_and_yield2.city_id and traindata_201712_all.province_id=sales_and_yield2.province_id
left join all_num_feature201612
on traindata_201712_all.class_id=all_num_feature201612.class_id and traindata_201712_all.city_id=all_num_feature201612.city_id and traindata_201712_all.province_id=all_num_feature201612.province_id;

drop table if exists final_slide_12month_inter2_all5;
CREATE TABLE if not exists final_slide_12month_inter2_all5(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
INSERT INTO final_slide_12month_inter2_all5(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12,lable)
select traindata_201712_all.*,all_num_feature201701.avgyear,all_num_feature201701.medianyear,all_num_feature201701.maxyear,all_num_feature201701.minyear,all_num_feature201701.stdyear,all_num_feature201701.sumyear,all_num_feature201701.monthyear, 2,sales_and_yield2.yield_201607,sales_and_yield2.yield_201608,sales_and_yield2.yield_201609,sales_and_yield2.yield_201610,sales_and_yield2.yield_201611,sales_and_yield2.yield_201612,sales_and_yield2.sale_201601,sales_and_yield2.sale_201602,sales_and_yield2.sale_201603,sales_and_yield2.sale_201604,sales_and_yield2.sale_201605,sales_and_yield2.sale_201606,sales_and_yield2.sale_201607,sales_and_yield2.sale_201608,sales_and_yield2.sale_201609,sales_and_yield2.sale_201610,sales_and_yield2.sale_201611,sales_and_yield2.sale_201612,sales_and_yield2.sale_201702
from traindata_201712_all left join sales_and_yield2 on traindata_201712_all.class_id=sales_and_yield2.class_id and traindata_201712_all.city_id=sales_and_yield2.city_id and traindata_201712_all.province_id=sales_and_yield2.province_id
left join all_num_feature201701
on traindata_201712_all.class_id=all_num_feature201701.class_id and traindata_201712_all.city_id=all_num_feature201701.city_id and traindata_201712_all.province_id=all_num_feature201701.province_id;

drop table if exists final_slide_12month_inter2_all6;
CREATE TABLE if not exists final_slide_12month_inter2_all6(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
INSERT INTO final_slide_12month_inter2_all6(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12,lable)
select traindata_201712_all.*,all_num_feature201702.avgyear,all_num_feature201702.medianyear,all_num_feature201702.maxyear,all_num_feature201702.minyear,all_num_feature201702.stdyear,all_num_feature201702.sumyear,all_num_feature201702.monthyear, 3,sales_and_yield2.yield_201608,sales_and_yield2.yield_201609,sales_and_yield2.yield_201610,sales_and_yield2.yield_201611,sales_and_yield2.yield_201612,sales_and_yield2.yield_201701,sales_and_yield2.sale_201602,sales_and_yield2.sale_201603,sales_and_yield2.sale_201604,sales_and_yield2.sale_201605,sales_and_yield2.sale_201606,sales_and_yield2.sale_201607,sales_and_yield2.sale_201608,sales_and_yield2.sale_201609,sales_and_yield2.sale_201610,sales_and_yield2.sale_201611,sales_and_yield2.sale_201612,sales_and_yield2.sale_201701,sales_and_yield2.sale_201703
from traindata_201712_all left join sales_and_yield2 on traindata_201712_all.class_id=sales_and_yield2.class_id and traindata_201712_all.city_id=sales_and_yield2.city_id and traindata_201712_all.province_id=sales_and_yield2.province_id
left join all_num_feature201702
on traindata_201712_all.class_id=all_num_feature201702.class_id and traindata_201712_all.city_id=all_num_feature201702.city_id and traindata_201712_all.province_id=all_num_feature201702.province_id;

drop table if exists final_slide_12month_inter2_all7;
CREATE TABLE if not exists final_slide_12month_inter2_all7(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
INSERT INTO final_slide_12month_inter2_all7(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12,lable)
select traindata_201712_all.*,all_num_feature201703.avgyear,all_num_feature201703.medianyear,all_num_feature201703.maxyear,all_num_feature201703.minyear,all_num_feature201703.stdyear,all_num_feature201703.sumyear,all_num_feature201703.monthyear, 4,sales_and_yield2.yield_201609,sales_and_yield2.yield_201610,sales_and_yield2.yield_201611,sales_and_yield2.yield_201612,sales_and_yield2.yield_201701,sales_and_yield2.yield_201702,sales_and_yield2.sale_201603,sales_and_yield2.sale_201604,sales_and_yield2.sale_201605,sales_and_yield2.sale_201606,sales_and_yield2.sale_201607,sales_and_yield2.sale_201608,sales_and_yield2.sale_201609,sales_and_yield2.sale_201610,sales_and_yield2.sale_201611,sales_and_yield2.sale_201612,sales_and_yield2.sale_201701,sales_and_yield2.sale_201702,sales_and_yield2.sale_201704
from traindata_201712_all left join sales_and_yield2 on traindata_201712_all.class_id=sales_and_yield2.class_id and traindata_201712_all.city_id=sales_and_yield2.city_id and traindata_201712_all.province_id=sales_and_yield2.province_id
left join all_num_feature201703
on traindata_201712_all.class_id=all_num_feature201703.class_id and traindata_201712_all.city_id=all_num_feature201703.city_id and traindata_201712_all.province_id=all_num_feature201703.province_id;

-- drop table if exists final_slide_12month_inter2_all8;
-- CREATE TABLE if not exists final_slide_12month_inter2_all8(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
-- INSERT INTO final_slide_12month_inter2_all8(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12,lable)
-- select traindata_201712_all.*,all_num_feature201704.avgyear,all_num_feature201704.medianyear,all_num_feature201704.maxyear,all_num_feature201704.minyear,all_num_feature201704.stdyear,all_num_feature201704.sumyear,all_num_feature201704.monthyear, 5,sales_and_yield2.yield_201610,sales_and_yield2.yield_201611,sales_and_yield2.yield_201612,sales_and_yield2.yield_201701,sales_and_yield2.yield_201702,sales_and_yield2.yield_201703,sales_and_yield2.sale_201604,sales_and_yield2.sale_201605,sales_and_yield2.sale_201606,sales_and_yield2.sale_201607,sales_and_yield2.sale_201608,sales_and_yield2.sale_201609,sales_and_yield2.sale_201610,sales_and_yield2.sale_201611,sales_and_yield2.sale_201612,sales_and_yield2.sale_201701,sales_and_yield2.sale_201702,sales_and_yield2.sale_201703,sales_and_yield2.sale_201705
-- from traindata_201712_all left join sales_and_yield2 on traindata_201712_all.class_id=sales_and_yield2.class_id and traindata_201712_all.city_id=sales_and_yield2.city_id and traindata_201712_all.province_id=sales_and_yield2.province_id
-- left join all_num_feature201704
-- on traindata_201712_all.class_id=all_num_feature201704.class_id and traindata_201712_all.city_id=all_num_feature201704.city_id and traindata_201712_all.province_id=all_num_feature201704.province_id;

-- drop table if exists final_slide_12month_inter2_all9;
-- CREATE TABLE if not exists final_slide_12month_inter2_all9(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
-- INSERT INTO final_slide_12month_inter2_all9(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12,lable)
-- select traindata_201712_all.*,all_num_feature201705.avgyear,all_num_feature201705.medianyear,all_num_feature201705.maxyear,all_num_feature201705.minyear,all_num_feature201705.stdyear,all_num_feature201705.sumyear,all_num_feature201705.monthyear, 6,sales_and_yield2.yield_201611,sales_and_yield2.yield_201612,sales_and_yield2.yield_201701,sales_and_yield2.yield_201702,sales_and_yield2.yield_201703,sales_and_yield2.yield_201704,sales_and_yield2.sale_201605,sales_and_yield2.sale_201606,sales_and_yield2.sale_201607,sales_and_yield2.sale_201608,sales_and_yield2.sale_201609,sales_and_yield2.sale_201610,sales_and_yield2.sale_201611,sales_and_yield2.sale_201612,sales_and_yield2.sale_201701,sales_and_yield2.sale_201702,sales_and_yield2.sale_201703,sales_and_yield2.sale_201704,sales_and_yield2.sale_201706
-- from traindata_201712_all left join sales_and_yield2 on traindata_201712_all.class_id=sales_and_yield2.class_id and traindata_201712_all.city_id=sales_and_yield2.city_id and traindata_201712_all.province_id=sales_and_yield2.province_id
-- left join all_num_feature201705
-- on traindata_201712_all.class_id=all_num_feature201705.class_id and traindata_201712_all.city_id=all_num_feature201705.city_id and traindata_201712_all.province_id=all_num_feature201705.province_id;

-- drop table if exists final_slide_12month_inter2_all10;
-- CREATE TABLE if not exists final_slide_12month_inter2_all10(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
-- INSERT INTO final_slide_12month_inter2_all10(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12,lable)
-- select traindata_201712_all.*,all_num_feature201706.avgyear,all_num_feature201706.medianyear,all_num_feature201706.maxyear,all_num_feature201706.minyear,all_num_feature201706.stdyear,all_num_feature201706.sumyear,all_num_feature201706.monthyear, 7,sales_and_yield2.yield_201612,sales_and_yield2.yield_201701,sales_and_yield2.yield_201702,sales_and_yield2.yield_201703,sales_and_yield2.yield_201704,sales_and_yield2.yield_201705,sales_and_yield2.sale_201606,sales_and_yield2.sale_201607,sales_and_yield2.sale_201608,sales_and_yield2.sale_201609,sales_and_yield2.sale_201610,sales_and_yield2.sale_201611,sales_and_yield2.sale_201612,sales_and_yield2.sale_201701,sales_and_yield2.sale_201702,sales_and_yield2.sale_201703,sales_and_yield2.sale_201704,sales_and_yield2.sale_201705,sales_and_yield2.sale_201707
-- from traindata_201712_all left join sales_and_yield2 on traindata_201712_all.class_id=sales_and_yield2.class_id and traindata_201712_all.city_id=sales_and_yield2.city_id and traindata_201712_all.province_id=sales_and_yield2.province_id
-- left join all_num_feature201706
-- on traindata_201712_all.class_id=all_num_feature201706.class_id and traindata_201712_all.city_id=all_num_feature201706.city_id and traindata_201712_all.province_id=all_num_feature201706.province_id;

-- drop table if exists final_slide_12month_inter2_all11;
-- CREATE TABLE if not exists final_slide_12month_inter2_all11(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
-- INSERT INTO final_slide_12month_inter2_all11(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12,lable)
-- select traindata_201712_all.*,all_num_feature201707.avgyear,all_num_feature201707.medianyear,all_num_feature201707.maxyear,all_num_feature201707.minyear,all_num_feature201707.stdyear,all_num_feature201707.sumyear,all_num_feature201707.monthyear, 8,sales_and_yield2.yield_201701,sales_and_yield2.yield_201702,sales_and_yield2.yield_201703,sales_and_yield2.yield_201704,sales_and_yield2.yield_201705,sales_and_yield2.yield_201706,sales_and_yield2.sale_201607,sales_and_yield2.sale_201608,sales_and_yield2.sale_201609,sales_and_yield2.sale_201610,sales_and_yield2.sale_201611,sales_and_yield2.sale_201612,sales_and_yield2.sale_201701,sales_and_yield2.sale_201702,sales_and_yield2.sale_201703,sales_and_yield2.sale_201704,sales_and_yield2.sale_201705,sales_and_yield2.sale_201706,sales_and_yield2.sale_201708
-- from traindata_201712_all left join sales_and_yield2 on traindata_201712_all.class_id=sales_and_yield2.class_id and traindata_201712_all.city_id=sales_and_yield2.city_id and traindata_201712_all.province_id=sales_and_yield2.province_id
-- left join all_num_feature201707
-- on traindata_201712_all.class_id=all_num_feature201707.class_id and traindata_201712_all.city_id=all_num_feature201707.city_id and traindata_201712_all.province_id=all_num_feature201707.province_id;

-- drop table if exists final_slide_12month_inter2_all12;
-- CREATE TABLE if not exists final_slide_12month_inter2_all12(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
-- INSERT INTO final_slide_12month_inter2_all12(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12,lable)
-- select traindata_201712_all.*,all_num_feature201708.avgyear,all_num_feature201708.medianyear,all_num_feature201708.maxyear,all_num_feature201708.minyear,all_num_feature201708.stdyear,all_num_feature201708.sumyear,all_num_feature201708.monthyear, 9,sales_and_yield2.yield_201702,sales_and_yield2.yield_201703,sales_and_yield2.yield_201704,sales_and_yield2.yield_201705,sales_and_yield2.yield_201706,sales_and_yield2.yield_201707,sales_and_yield2.sale_201608,sales_and_yield2.sale_201609,sales_and_yield2.sale_201610,sales_and_yield2.sale_201611,sales_and_yield2.sale_201612,sales_and_yield2.sale_201701,sales_and_yield2.sale_201702,sales_and_yield2.sale_201703,sales_and_yield2.sale_201704,sales_and_yield2.sale_201705,sales_and_yield2.sale_201706,sales_and_yield2.sale_201707,sales_and_yield2.sale_201709
-- from traindata_201712_all left join sales_and_yield2 on traindata_201712_all.class_id=sales_and_yield2.class_id and traindata_201712_all.city_id=sales_and_yield2.city_id and traindata_201712_all.province_id=sales_and_yield2.province_id
-- left join all_num_feature201708
-- on traindata_201712_all.class_id=all_num_feature201708.class_id and traindata_201712_all.city_id=all_num_feature201708.city_id and traindata_201712_all.province_id=all_num_feature201708.province_id;

-- drop table if exists final_slide_12month_inter2_all13;
-- CREATE TABLE if not exists final_slide_12month_inter2_all13(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
-- INSERT INTO final_slide_12month_inter2_all13(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12,lable)
-- select traindata_201712_all.*,all_num_feature201709.avgyear,all_num_feature201709.medianyear,all_num_feature201709.maxyear,all_num_feature201709.minyear,all_num_feature201709.stdyear,all_num_feature201709.sumyear,all_num_feature201709.monthyear, 10,sales_and_yield2.yield_201703,sales_and_yield2.yield_201704,sales_and_yield2.yield_201705,sales_and_yield2.yield_201706,sales_and_yield2.yield_201707,sales_and_yield2.yield_201708,sales_and_yield2.sale_201609,sales_and_yield2.sale_201610,sales_and_yield2.sale_201611,sales_and_yield2.sale_201612,sales_and_yield2.sale_201701,sales_and_yield2.sale_201702,sales_and_yield2.sale_201703,sales_and_yield2.sale_201704,sales_and_yield2.sale_201705,sales_and_yield2.sale_201706,sales_and_yield2.sale_201707,sales_and_yield2.sale_201708,sales_and_yield2.sale_201710
-- from traindata_201712_all left join sales_and_yield2 on traindata_201712_all.class_id=sales_and_yield2.class_id and traindata_201712_all.city_id=sales_and_yield2.city_id and traindata_201712_all.province_id=sales_and_yield2.province_id
-- left join all_num_feature201709
-- on traindata_201712_all.class_id=all_num_feature201709.class_id and traindata_201712_all.city_id=all_num_feature201709.city_id and traindata_201712_all.province_id=all_num_feature201709.province_id;

-- drop table if exists final_slide_12month_inter2_all14;
-- CREATE TABLE if not exists final_slide_12month_inter2_all14(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
-- INSERT INTO final_slide_12month_inter2_all14(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12,lable)
-- select traindata_201712_all.*,all_num_feature201710.avgyear,all_num_feature201710.medianyear,all_num_feature201710.maxyear,all_num_feature201710.minyear,all_num_feature201710.stdyear,all_num_feature201710.sumyear,all_num_feature201710.monthyear, 11,sales_and_yield2.yield_201704,sales_and_yield2.yield_201705,sales_and_yield2.yield_201706,sales_and_yield2.yield_201707,sales_and_yield2.yield_201708,sales_and_yield2.yield_201709,sales_and_yield2.sale_201610,sales_and_yield2.sale_201611,sales_and_yield2.sale_201612,sales_and_yield2.sale_201701,sales_and_yield2.sale_201702,sales_and_yield2.sale_201703,sales_and_yield2.sale_201704,sales_and_yield2.sale_201705,sales_and_yield2.sale_201706,sales_and_yield2.sale_201707,sales_and_yield2.sale_201708,sales_and_yield2.sale_201709,sales_and_yield2.sale_201711
-- from traindata_201712_all left join sales_and_yield2 on traindata_201712_all.class_id=sales_and_yield2.class_id and traindata_201712_all.city_id=sales_and_yield2.city_id and traindata_201712_all.province_id=sales_and_yield2.province_id
-- left join all_num_feature201710
-- on traindata_201712_all.class_id=all_num_feature201710.class_id and traindata_201712_all.city_id=all_num_feature201710.city_id and traindata_201712_all.province_id=all_num_feature201710.province_id;

-- drop table if exists final_slide_12month_inter2_all15;
-- CREATE TABLE if not exists final_slide_12month_inter2_all15(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
-- INSERT INTO final_slide_12month_inter2_all15(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12,lable)
-- select traindata_201712_all.*,all_num_feature201711.avgyear,all_num_feature201711.medianyear,all_num_feature201711.maxyear,all_num_feature201711.minyear,all_num_feature201711.stdyear,all_num_feature201711.sumyear,all_num_feature201711.monthyear, 12,sales_and_yield2.yield_201705,sales_and_yield2.yield_201706,sales_and_yield2.yield_201707,sales_and_yield2.yield_201708,sales_and_yield2.yield_201709,sales_and_yield2.yield_201710,sales_and_yield2.sale_201611,sales_and_yield2.sale_201612,sales_and_yield2.sale_201701,sales_and_yield2.sale_201702,sales_and_yield2.sale_201703,sales_and_yield2.sale_201704,sales_and_yield2.sale_201705,sales_and_yield2.sale_201706,sales_and_yield2.sale_201707,sales_and_yield2.sale_201708,sales_and_yield2.sale_201709,sales_and_yield2.sale_201710,sales_and_yield2.sale_201712
-- from traindata_201712_all left join sales_and_yield2 on traindata_201712_all.class_id=sales_and_yield2.class_id and traindata_201712_all.city_id=sales_and_yield2.city_id and traindata_201712_all.province_id=sales_and_yield2.province_id
-- left join all_num_feature201711
-- on traindata_201712_all.class_id=all_num_feature201711.class_id and traindata_201712_all.city_id=all_num_feature201711.city_id and traindata_201712_all.province_id=all_num_feature201711.province_id;


-- 最终的训练集制作
drop table if exists final_slide_12month_inter2_all_201802;
create table final_slide_12month_inter2_all_201802(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
-- insert into final_slide_12month_inter2_all_201802 select * from final_slide_12month_inter2_all0;
-- insert into final_slide_12month_inter2_all_201802 select * from final_slide_12month_inter2_all1;
-- insert into final_slide_12month_inter2_all_201802 select * from final_slide_12month_inter2_all2;
-- insert into final_slide_12month_inter2_all_201802 select * from final_slide_12month_inter2_all3;
insert into final_slide_12month_inter2_all_201802 select * from final_slide_12month_inter2_all4;
insert into final_slide_12month_inter2_all_201802 select * from final_slide_12month_inter2_all5;
insert into final_slide_12month_inter2_all_201802 select * from final_slide_12month_inter2_all6;
insert into final_slide_12month_inter2_all_201802 select * from final_slide_12month_inter2_all7;
insert into final_slide_12month_inter2_all_201802 select * from final_slide_12month_inter2_all8;
insert into final_slide_12month_inter2_all_201802 select * from final_slide_12month_inter2_all9;
insert into final_slide_12month_inter2_all_201802 select * from final_slide_12month_inter2_all10;
insert into final_slide_12month_inter2_all_201802 select * from final_slide_12month_inter2_all11;
insert into final_slide_12month_inter2_all_201802 select * from final_slide_12month_inter2_all12;
insert into final_slide_12month_inter2_all_201802 select * from final_slide_12month_inter2_all13;
insert into final_slide_12month_inter2_all_201802 select * from final_slide_12month_inter2_all14;
insert into final_slide_12month_inter2_all_201802 select * from final_slide_12month_inter2_all15;


-- 有四个月验证的训练集制作
drop table if exists final_slide_12month_inter2_all_verify;
create table final_slide_12month_inter2_all_verify(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint,lable bigint);
insert into final_slide_12month_inter2_all_verify select * from final_slide_12month_inter2_all0;
insert into final_slide_12month_inter2_all_verify select * from final_slide_12month_inter2_all1;
insert into final_slide_12month_inter2_all_verify select * from final_slide_12month_inter2_all2;
insert into final_slide_12month_inter2_all_verify select * from final_slide_12month_inter2_all3;
insert into final_slide_12month_inter2_all_verify select * from final_slide_12month_inter2_all4;
insert into final_slide_12month_inter2_all_verify select * from final_slide_12month_inter2_all5;
insert into final_slide_12month_inter2_all_verify select * from final_slide_12month_inter2_all6;
insert into final_slide_12month_inter2_all_verify select * from final_slide_12month_inter2_all7;
insert into final_slide_12month_inter2_all_verify select * from final_slide_12month_inter2_all8;
insert into final_slide_12month_inter2_all_verify select * from final_slide_12month_inter2_all9;
insert into final_slide_12month_inter2_all_verify select * from final_slide_12month_inter2_all10;
insert into final_slide_12month_inter2_all_verify select * from final_slide_12month_inter2_all11;
-- insert into slide_12month_train_201801 select * from slide_12month_train_feature_all12;
-- insert into slide_12month_train_201801 select * from slide_12month_train_feature_all13;
-- insert into slide_12month_train_201801 select * from slide_12month_train_feature_all114;
-- insert into slide_12month_train_201801 select * from slide_12month_train_feature_all115;


-- 测试集制作 无lable 此处有问题，选错数据表了
drop table if exists final_slide_12month_inter2_all_test;
CREATE TABLE if not exists final_slide_12month_inter2_all_test(province_id bigint,city_id bigint,class_id bigint,avg_feature bigint,median_feature bigint,max_feature bigint,min_feature bigint,std_feature double,sum_feature bigint,month_sum_feature bigint,month_seq bigint,yield1 bigint,yield2 bigint,yield3 bigint,yield4 bigint,yield5 bigint,yield6 bigint,month1 bigint,month2 bigint,month3 bigint,month4 bigint,month5 bigint,month6 bigint,month7 bigint,month8 bigint,month9 bigint,month10 bigint,month11 bigint,month12 bigint);
INSERT INTO final_slide_12month_inter2_all_test(province_id,city_id,class_id,avg_feature,median_feature,max_feature,min_feature,std_feature,sum_feature,month_sum_feature,month_seq,yield1,yield2,yield3,yield4,yield5,yield6,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12)
select traindata_201712_all.*,all_num_feature201801.avgyear,all_num_feature201801.medianyear,all_num_feature201801.maxyear,all_num_feature201801.minyear,all_num_feature201801.stdyear,all_num_feature201801.sumyear,all_num_feature201801.monthyear, 2,sales_yield_radio_sum_ave_median2.yield_201707,sales_yield_radio_sum_ave_median2.yield_201708,sales_yield_radio_sum_ave_median2.yield_201709,sales_yield_radio_sum_ave_median2.yield_201710,sales_yield_radio_sum_ave_median2.yield_201711,sales_yield_radio_sum_ave_median2.yield_201712,sales_yield_radio_sum_ave_median2.sale_201701,sales_yield_radio_sum_ave_median2.sale_201702,sales_yield_radio_sum_ave_median2.sale_201703,sales_yield_radio_sum_ave_median2.sale_201704,sales_yield_radio_sum_ave_median2.sale_201705,sales_yield_radio_sum_ave_median2.sale_201706,sales_yield_radio_sum_ave_median2.sale_201707,sales_yield_radio_sum_ave_median2.sale_201708,sales_yield_radio_sum_ave_median2.sale_201709,sales_yield_radio_sum_ave_median2.sale_201710,sales_yield_radio_sum_ave_median2.sale_201711,sales_yield_radio_sum_ave_median2.sale_201712
from traindata_201712_all left join sales_yield_radio_sum_ave_median2 on traindata_201712_all.class_id=sales_yield_radio_sum_ave_median2.class_id and traindata_201712_all.city_id=sales_yield_radio_sum_ave_median2.city_id and traindata_201712_all.province_id=sales_yield_radio_sum_ave_median2.province_id
left join all_num_feature201801
on traindata_201712_all.class_id=all_num_feature201801.class_id and traindata_201712_all.city_id=all_num_feature201801.city_id and traindata_201712_all.province_id=all_num_feature201801.province_id;







